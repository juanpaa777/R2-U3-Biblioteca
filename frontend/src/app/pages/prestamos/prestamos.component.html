<div class="prestamos-container">
  <h2>Registrar un PrÃ©stamo</h2>

  <div *ngIf="tituloLibro" class="aviso-prestamo">
    <p>ğŸ“š Registrando prÃ©stamo para: <strong>{{ tituloLibro }}</strong></p>
  </div>

  <form (ngSubmit)="registrarPrestamo()" #prestamoForm="ngForm">
    <div class="form-group">
      <label for="usuario">Buscar Usuario:</label>
      <input
        type="text"
        id="usuario"
        name="usuario"
        [(ngModel)]="terminoBusqueda"
        (input)="buscarSugerencias()"
        autocomplete="off"
        placeholder="Escribe nombre o matrÃ­cula..."
        required
      />

      <div class="sugerencias" *ngIf="sugerencias.length > 0">
        <div
          *ngFor="let sugerencia of sugerencias"
          class="sugerencia-item"
          (click)="seleccionarUsuario(sugerencia)"
        >
          {{ sugerencia.nombre }} {{ sugerencia.apellido }} â€” {{ sugerencia.matricula }}
        </div>
      </div>
    </div>

    <div class="form-group">
      <label>ISBN del libro:</label>
      <input
        type="text"
        [(ngModel)]="isbn"
        name="isbn"
        [readonly]="isbnBloqueado"
        required
      />
    </div>

    <button type="submit" [disabled]="!prestamoForm.valid || !matricula">
      Registrar PrÃ©stamo
    </button>

    <div *ngIf="mensaje && !mensajeExito" class="mensaje">
      {{ mensaje }}
    </div>
  </form>
</div>

<!-- Modal de Ã‰xito: fuera de .prestamos-container -->
<div *ngIf="mensajeExito" class="modal-exito" (click)="cerrarModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h3>Â¡Ã‰xito!</h3>
    <p>{{ mensaje }}</p>
    <button (click)="cerrarModal()">Cerrar</button>
  </div>
</div>
